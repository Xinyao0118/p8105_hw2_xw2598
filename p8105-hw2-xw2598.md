p8105\_hw2\_xw2598
================
Xinyao Wu
2018-10-02

problem1
--------

``` r
library(tidyverse)
```

    ## -- Attaching packages ---------------------------------------------------------- tidyverse 1.2.1 --

    ## √ ggplot2 3.0.0     √ purrr   0.2.5
    ## √ tibble  1.4.2     √ dplyr   0.7.6
    ## √ tidyr   0.8.1     √ stringr 1.3.1
    ## √ readr   1.1.1     √ forcats 0.3.0

    ## -- Conflicts ------------------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
nyc_data = read.csv("./data files/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")%>% 
  #data clean
janitor::clean_names() %>% 
  #retain specific variables 
select(line:entry,vending,ada) %>% 
  #convert the variable entry from character to logic
 #gather(key="routes_served", value = "route_value",route1:route11 ) %>% 
mutate(
     entry=as.character(entry),
     entry = replace(entry,entry =="YES", "TRUE"),
       entry =replace(entry,entry =="NO","FALSE"),
       entry = as.logical(entry)
)
```

``` r
#new dataset variables
names(nyc_data) 
```

    ##  [1] "line"              "station_name"      "station_latitude" 
    ##  [4] "station_longitude" "route1"            "route2"           
    ##  [7] "route3"            "route4"            "route5"           
    ## [10] "route6"            "route7"            "route8"           
    ## [13] "route9"            "route10"           "route11"          
    ## [16] "entrance_type"     "entry"             "vending"          
    ## [19] "ada"

``` r
#The dimension of the resulting dataset
print("rows:")
```

    ## [1] "rows:"

``` r
nrow(nyc_data)
```

    ## [1] 1868

``` r
print("columns:")
```

    ## [1] "columns:"

``` r
ncol(nyc_data)
```

    ## [1] 19

This dataset contains variables: line,station name,station latitude,station longitude,route1,route2,route3,route4,route5,route6,route7,route8,route9,route10,route11,entrance type,entry,vending,ada. My data cleaning steps: 1.Change the variables names. 2.Select the specific variables according to the requirement. 3.Change the type of the data in "entry". The dimension of the resulting dataset is 1868 rows \* 19 columns.These data is not tidy enough, I suggest to gather all of the routes into one variable so I put related codes in the comment lines.

``` r
##The number of distinct stations:
#select the variables that can identify stations
n_station = select(nyc_data,line,station_name,ada) %>% 
distinct()
nrow(n_station)
```

    ## [1] 465

``` r
##The number of stations that are ADA compliant
ada_compliant = filter(n_station, ada=="TRUE") 
  nrow(ada_compliant)
```

    ## [1] 84

``` r
##The proportion of station entrances / exits without vending allow entrance
nrow(filter(nyc_data,vending=="NO",entry=="TRUE"))/nrow(filter(nyc_data,vending=="NO"))
```

    ## [1] 0.3770492

There are 465 distinct stations, and there are 84 stations that are ADA compliant.The proportion of station entrances / exits without vending allow entrance is 0.377.

``` r
#Reformat data so that route number and route name are distinct variables
new_nyc_data = nyc_data %>% 
gather(key="route_name", value = "route_number",route1:route11 ) %>% 
#Number of Dinstinct stations that serve the A train
select(line,station_name, route_name, route_number,ada) %>% 
  #filte A train
  filter(route_number == "A") 
```

    ## Warning: attributes are not identical across measure variables;
    ## they will be dropped

``` r
  #count distinct station serving A train
  A_station = distinct(new_nyc_data,line,station_name,.keep_all = TRUE) 
  nrow(A_station)
```

    ## [1] 60

``` r
# carculate number  of  ADA compliant in stations serving A train
  nrow(filter(A_station,ada=="TRUE"))
```

    ## [1] 17

``` r
# carculate proportion of  ADA compliant in stations serving A train
  nrow(filter(A_station,ada=="TRUE"))/nrow(A_station)
```

    ## [1] 0.2833333

60 distinct stations that serve the A train Of the stations that serve the A train, the number of ada compliant stations serving A train is , and the proportion of ADA compliant is 0.283.

problem 2
---------

Read and clean the Mr. Trash Wheel sheet:

``` r
library(readxl)
#read data and omit columns containing notes
trash = read_excel("./data files/HealthyHarborWaterWheelTotals2017-9-26.xlsx",range = "A2:N258") %>% 
  #data clean 
  janitor::clean_names() %>% 
  #omit rows that do not include dumpster-specific data
  filter(dumpster!="NA")
#rounds the number of sports balls and convert then into integer variables
trash$sports_balls = as.integer(round(trash$sports_balls))
```

``` r
#Read and clean precipitation data for 2017
precipitation_17 = read_excel("./data files/HealthyHarborWaterWheelTotals2017-9-26.xlsx",sheet = "2017 Precipitation",range = "A2:B15") %>% 
  janitor::clean_names() %>% 
#omit rows without precipitation data and add a variable year
  filter(total != "NA") 
  precipitation_17$year =  c(rep(2017,9))

#same pipline in 2016 
precipitation_16 = read_excel("./data files/HealthyHarborWaterWheelTotals2017-9-26.xlsx",sheet = "2016 Precipitation",range = "A2:B15") %>%
  janitor::clean_names() %>% 
   filter(total != "NA") 
  precipitation_16$year =  c(rep(2016,13))
#combine datasets and convert month to a character variable
  precipitation = left_join(precipitation_16, precipitation_17, by = "month",suffix = c(".16", ".17"))
  precipitation$month = month.name[precipitation$month]
  precipitation = select(precipitation,month, starts_with("total")) %>% 
    gather(key="year",value = "total",starts_with("total")) %>% 
    mutate(
      year = replace(year, year == "total.16","2016"),
      year = replace(year, year == "total.17","2017")
    ) %>% 
    filter(total != "NA")
    
##About these data
  head(precipitation)
```

    ## # A tibble: 6 x 3
    ##   month    year  total
    ##   <chr>    <chr> <dbl>
    ## 1 January  2016   3.23
    ## 2 February 2016   5.32
    ## 3 March    2016   2.24
    ## 4 April    2016   1.78
    ## 5 May      2016   5.19
    ## 6 June     2016   3.2

``` r
#The separate datas (2016 and 2017) respectively include 3 variables : month ,total precipitation and year.Their combination dataset(named precipitation) includes 3 variables:month,total precipitation,year
#Key variables: total precipitation. Because this is the core of this dataset.other variables are made for organizing and grouping "precipitation".

# total precipitation in 2017
  sum(filter(precipitation_17,month != "NA")$total)
```

    ## [1] 29.93

``` r
# the median number of sports balls in a dumpster in 2016
  median(filter(trash,year=="2016")$sports_balls)
```

    ## [1] 26

The total precipitation in 2017 is 29.93 and the median number of sports balls in a dumpster in 2016 is 26.

problem3
--------
